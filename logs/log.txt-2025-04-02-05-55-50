***************
** Arguments **
***************
agnostic: True
algorithm: tabu
api_idx: 0
backbone: tlite
batch_size: 4
budget: 1000
checkpoint_freq: 10
classification_task_ids: ['019', '001', '022', '050', '069', '137', '139', '195']
config_file: 
data_dir: ./data/
data_seed: 42
dataset_config_file: 
edits: ['del', 'swap', 'sub', 'add']
eval_only: False
key_id: 0
level: phrase
load_epoch: None
meta_dir: ./logs/
meta_name: TS_batchsize_4_all_edits_l_1_m_8_n_20@task_001_agnostic_trainseed_0_seed_42_rho_7.txt
mode: Instruction Only
model_dir: 
model_name: text-babbage-001
no_train: False
num_candidates: 8
num_compose: 1
num_iter: 3
num_samples: 100
num_shots: 2
num_train: 100
opts: []
output_dir: ./output/
patience: 5
print_orig: True
project_name: ts-prompt
resume: 
simulated_anneal: False
task_idx: 2
tournament_selection: 4
train_seed: 0
transforms: None
write_preds: True
************
** Config **
************
DATALOADER:
  K_TRANSFORMS: 1
  NUM_WORKERS: 4
  RETURN_IMG0: False
  TEST:
    BATCH_SIZE: 32
    SAMPLER: SequentialSampler
  TRAIN_U:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAME_AS_X: True
    SAMPLER: RandomSampler
  TRAIN_X:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAMPLER: RandomSampler
DATASET:
  ALL_AS_UNLABELED: False
  CIFAR_C_LEVEL: 1
  CIFAR_C_TYPE: 
  NAME: 
  NUM_LABELED: -1
  NUM_SHOTS: -1
  ROOT: 
  SOURCE_DOMAINS: ()
  STL10_FOLD: -1
  SUBSAMPLE_CLASSES: all
  TARGET_DOMAINS: ()
  VAL_PERCENT: 0.1
DATA_SEED: 42
INPUT:
  COLORJITTER_B: 0.4
  COLORJITTER_C: 0.4
  COLORJITTER_H: 0.1
  COLORJITTER_S: 0.4
  CROP_PADDING: 4
  CUTOUT_LEN: 16
  CUTOUT_N: 1
  GB_K: 21
  GB_P: 0.5
  GN_MEAN: 0.0
  GN_STD: 0.15
  INTERPOLATION: bilinear
  NO_TRANSFORM: False
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  RANDAUGMENT_M: 10
  RANDAUGMENT_N: 2
  RGS_P: 0.2
  ROTATE_ANGLE_LIST: [0]
  RRCROP_SCALE: (0.08, 1.0)
  SIZE: (224, 224)
  TRANSFORMS: ()
META_DIR: ./logs/
MODEL:
  BACKBONE:
    NAME: 
    PRETRAINED: True
  HEAD:
    ACTIVATION: relu
    BN: True
    DROPOUT: 0.0
    HIDDEN_LAYERS: ()
    NAME: 
  INIT_WEIGHTS: 
OPTIM:
  ADAM_BETA1: 0.9
  ADAM_BETA2: 0.999
  BASE_LR_MULT: 0.1
  GAMMA: 0.1
  GRAD_ACCU_STEPS: 8
  LR: 0.0003
  LR_SCHEDULER: single_step
  MAX_EPOCH: 10
  MOMENTUM: 0.9
  NAME: adam
  NEW_LAYERS: ()
  RMSPROP_ALPHA: 0.99
  SGD_DAMPNING: 0
  SGD_NESTEROV: False
  STAGED_LR: False
  STEPSIZE: (-1,)
  WARMUP_CONS_LR: 1e-05
  WARMUP_EPOCH: -1
  WARMUP_MIN_LR: 1e-05
  WARMUP_RECOUNT: True
  WARMUP_TYPE: linear
  WEIGHT_DECAY: 0.0005
OUTPUT_DIR: ./output/
RESUME: 
SEED: -1
TEST:
  COMPUTE_CMAT: False
  EVALUATOR: Classification
  FINAL_MODEL: last_step
  NO_TEST: False
  PER_CLASS_RESULT: False
  SPLIT: test
TRAIN:
  CHECKPOINT_FREQ: 0
  COUNT_ITER: train_x
  PRINT_FREQ: 10
TRAINER:
  CDAC:
    CLASS_LR_MULTI: 10
    P_THRESH: 0.95
    RAMPUP_COEF: 30
    RAMPUP_ITRS: 1000
    STRONG_TRANSFORMS: ()
    TOPK_MATCH: 5
  CROSSGRAD:
    ALPHA_D: 0.5
    ALPHA_F: 0.5
    EPS_D: 1.0
    EPS_F: 1.0
  DAEL:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DAELDG:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DDAIG:
    ALPHA: 0.5
    CLAMP: False
    CLAMP_MAX: 1.0
    CLAMP_MIN: -1.0
    G_ARCH: 
    LMDA: 0.3
    WARMUP: 0
  DOMAINMIX:
    ALPHA: 1.0
    BETA: 1.0
    TYPE: crossdomain
  ENTMIN:
    LMDA: 0.001
  FIXMATCH:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 1.0
  GA:
    PREC: fp16
  M3SDA:
    LMDA: 0.5
    N_STEP_F: 4
  MCD:
    N_STEP_F: 4
  MEANTEACHER:
    EMA_ALPHA: 0.999
    RAMPUP: 5
    WEIGHT_U: 1.0
  MIXMATCH:
    MIXUP_BETA: 0.75
    RAMPUP: 20000
    TEMP: 2.0
    WEIGHT_U: 100.0
  MME:
    LMDA: 0.1
  NAME: 
  SE:
    CONF_THRE: 0.95
    EMA_ALPHA: 0.999
    RAMPUP: 300
TRAIN_SEED: 0
USE_CUDA: True
VERBOSE: True
VERSION: 1
Collecting env info ...
./data/
dict_keys(['task022'])
dict_values(['task022_cosmosqa_passage_inappropriate_binary.json'])
Chosen Task:  022
Running Experiment for:  task022_cosmosqa_passage_inappropriate_binary.json
Task Labels:  ['No', 'Yes']
Original Instruction:  ['Read the given context and if the the context is inappropriate (e.g., pornographic) or nonsensical (e.g., cannot determine what happenings the context is about), indicate via "yes". Otherwise, response via "no".']
Instruction Edit1:  ['Read the given context and if the the context is inappropriate (e.g., pornographic) or nonsensical (e.g., cannot determine what happenings the context is about), indicate via "yes". Otherwise, response via "no".']
Instruction Edit2:  Read the given context and if the the context is inappropriate (e.g., pornographic) or nonsensical (e.g., cannot determine what happenings the context is about), indicate via "yes". Otherwise, response via "no".
Sanity Check, Task Labels are:  [' No', ' Yes']
generating sequence for prompts len 4: ["Definition: You will be given a task . Read and understand the task carefully, and appropriately answer 'No' or 'Yes'.\ninput: Context: If you 're wondering why he had n't done this already , it 's because work has been extremely busy recently and there has n't been time . So , that brings me back to the girls and their bugs . We caught several toads in the grass while watching Dad on the roof . They had a great time holding them , watching them jump , etc .\noutput:", "Definition: You will be given a task . Read and understand the task carefully, and appropriately answer 'No' or 'Yes'.\ninput: Context: I already called the company and they said they will come check it out but Hurricane Ike caused a lot of damage so a lot of people already called so they are expected to come check it in weeks . We already tried to do everything they told us to do like plug it in and out and restart the system but nothing helped ! We even went on the roof and made sure all the wires and everything were secure and the dish was perfect . We checked if the wires in the attic were secure too .\noutput:", "Definition: You will be given a task . Read and understand the task carefully, and appropriately answer 'No' or 'Yes'.\ninput: Context: Jangan cuba nak tipu kita la ! Oi you ingat kita bodoh ka ! ? ? ! ! Wah I tell you , if can I wanted to go down and kick down his door and beat him up lo . But can not la , since I 'm only like 45 kg and he 's this rough Indian taxi driver ( altho I think at that point I was more cho lo than him la heh ) .\noutput:", "Definition: You will be given a task . Read and understand the task carefully, and appropriately answer 'No' or 'Yes'.\ninput: Context: Worse still , when both of them rings ! Which one am I suppose to pick up ? We have one of those headsets thingy for the phones , but I had no idea how to use it . I always thought it was pretty cool .\noutput:"]
logprobs torch.Size([4, 50, 20]) tensor([[[-1.0404, -2.3138, -2.8763,  ..., -4.7669, -4.7982, -4.8060],
         [-0.6297, -1.3641, -1.6766,  ..., -8.6297, -8.9969, -9.1609],
         [-0.4989, -3.0067, -3.2254,  ..., -5.3192, -5.5926, -5.8036],
         ...,
         [-1.4884, -2.3087, -2.5899,  ..., -5.0821, -5.1368, -5.1524],
         [-0.8535, -1.4941, -2.1191,  ..., -5.7285, -5.8145, -5.8457],
         [-0.0869, -2.8994, -4.0087,  ..., -9.2587, -9.2822, -9.3212]],

        [[-1.1574, -2.4699, -2.7980,  ..., -4.6886, -4.7667, -4.9152],
         [-0.3923, -1.7360, -2.2048,  ..., -8.4079, -8.4235, -8.5094],
         [-0.6254, -2.6879, -3.2191,  ..., -5.3754, -5.4535, -5.4535],
         ...,
         [-0.2972, -1.6410, -3.7816,  ..., -8.0394, -8.0472, -8.1332],
         [-1.6075, -1.9044, -1.9981,  ..., -5.1856, -5.2247, -5.2637],
         [-0.3279, -3.7576, -3.8982,  ..., -5.7264, -5.7264, -5.8201]],

        [[-1.0642, -1.5407, -3.3532,  ..., -5.2204, -5.2595, -5.2595],
         [-0.3797, -1.4265, -2.8172,  ..., -8.9578, -9.0515, -9.0828],
         [-0.3795, -3.3638, -3.4185,  ..., -5.6920, -5.7232, -5.7623],
         ...,
         [-1.0766, -1.6391, -2.9203,  ..., -4.8422, -5.0141, -5.1235],
         [-2.5803, -2.6272, -2.9397,  ..., -4.2210, -4.4397, -4.4632],
         [-2.2756, -2.5490, -3.1427,  ..., -4.4709, -4.5568, -4.5646]],

        [[-0.6035, -1.2285, -3.9472,  ..., -6.2753, -6.3769, -6.4706],
         [-0.7672, -0.9234, -2.1109,  ..., -9.3375, -9.5718, -9.7515],
         [-0.2921, -3.4405, -3.7218,  ..., -6.0499, -6.0499, -6.0655],
         ...,
         [-0.0108, -6.4326, -7.1983,  ..., -8.9873, -9.0889, -9.3155],
         [-1.8651, -2.7479, -2.9354,  ..., -4.4979, -4.5370, -4.6073],
         [-1.0009, -1.1884, -2.4384,  ..., -6.1884, -6.2196, -6.2977]]])
complete_tlite has been used: 1x
